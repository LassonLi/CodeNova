<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Codenova Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f6f6f6;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 1600px;
      margin: 0 auto;
      padding: 40px;
    }
    .header {
      display: flex;
      align-items: center;
      margin-bottom: 40px;
    }
    .logo {
      width: 50px;
      height: 50px;
      margin-right: 15px;
    }
    .logo-text {
      font-size: 28px;
      font-weight: bold;
      color: #0d274d;
    }
    .card {
      background-color: white;
      border-radius: 10px;
      padding: 25px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      display: flex;
      flex-direction: column;
    }
    .card h2 {
      font-size: 20px;
      margin: 0 0 15px;
    }
    .card p {
      font-size: 24px;
      font-weight: bold;
      margin: 0;
    }
    canvas {
      width: 100% !important;
      height: auto !important;
      margin-top: auto;
    }
    .history-table {
      width: 100%;
      border-collapse: collapse;
    }
    .history-table th, .history-table td {
      text-align: left;
      padding: 10px;
      border-bottom: 1px solid #ddd;
    }
    .history-table th {
      font-weight: bold;
    }
    .refresh-button {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      background-color: #0066ff;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 15px;
      margin-bottom: 10px;
    }
    .timestamp {
      font-size: 12px;
      color: #888;
      text-align: center;
    }
    #networth-card {
      background-color: #0d274d;
      color: white;
    }
    #networth-card h2 {
      font-size: 24px;
    }
    #networth-card p {
      font-size: 36px;
    }
    .asset-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 0;
      font-size: 16px;
      border-bottom: 1px solid #f0f0f0;
    }
    .asset-item:last-child {
      border-bottom: none;
    }
    .asset-item span:last-child {
      font-weight: bold;
    }
    .asset-list-container {
      max-height: 130px; 
      overflow-y: auto;
      padding-right: 10px;
    }
    .asset-list-container::-webkit-scrollbar {
      width: 6px;
    }
    .asset-list-container::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 10px;
    }
    .asset-list-container::-webkit-scrollbar-thumb {
      background: #ccc;
      border-radius: 10px;
    }
    .asset-list-container::-webkit-scrollbar-thumb:hover {
      background: #aaa;
    }
    .card-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }
    .card-action-button {
      flex-grow: 1;
      padding: 8px;
      font-size: 14px;
      font-weight: bold;
      border: 1px solid #ddd;
      background-color: #f9f9f9;
      border-radius: 5px;
      cursor: pointer;
      text-align: center;
      transition: background-color 0.2s;
    }
    .card-action-button:hover {
      background-color: #f0f0f0;
    }
    
    #stock-list-container {
      flex-grow: 1;
      overflow-y: auto;
    }
    
    .stock-info-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid #f0f0f0;
    }
    .stock-info-item:last-child {
      border-bottom: none;
    }
    
    .stock-details {
      display: flex;
      flex-direction: column;
    }
    .stock-details .code {
      font-weight: bold;
      font-size: 16px;
    }
    .stock-details .price {
      font-size: 14px;
      color: #555;
    }
    
    .stock-change {
      font-weight: bold;
      font-size: 15px;
      padding: 4px 8px;
      border-radius: 5px;
      color: white;
    }
    .stock-change.positive {
      background-color: #28a745;
    }
    .stock-change.negative {
      background-color: #dc3545;
    }

    /* --- 全局布局重构 --- */
    .dashboard {
      display: grid;
      grid-template-columns: 1fr 2fr 1.2fr;
      grid-template-rows: auto auto auto auto 1fr; /* 让最后一行可以伸展 */
      gap: 30px;
    }

    /* --- 为每个卡片分配网格位置 --- */
    #networth-card { grid-column: 1; grid-row: 1; }
    #stock-assets-card { grid-column: 1; grid-row: 2; }
    #bond-card { grid-column: 1; grid-row: 3; }
    #cash-card { grid-column: 1; grid-row: 4; }

    #stock-chart-card { grid-column: 2; grid-row: 1 / 3; }
    #market-watch-card { grid-column: 3; grid-row: 1 / 3; }

    #portfolio-card { grid-column: 2 / 4; grid-row: 3 / 5; }

    #history-card { grid-column: 1 / 4; grid-row: 5; }

    /* --- Portfolio 卡片内部布局 --- */
    #portfolio-charts-container {
      display: flex;
      flex-direction: row;
      justify-content: space-around;
      align-items: center;
      width: 100%;
      flex-grow: 1;
      gap: 20px;
    }
    .portfolio-chart-wrapper {
      flex: 1;
      max-width: 45%;
    }

    .chart-container-large {
        flex-grow: 1;
        position: relative;
        min-height: 350px;
    }

    .chart-container-large canvas {
        position: absolute;
        top: 0;
        left: 0;
        width: 100% !important;
        height: 100% !important;
    }
    
    .amount-positive {
        color: #28a745;
        font-weight: bold;
    }
    .amount-negative {
        color: #dc3545;
        font-weight: bold;
    }
    
    /* ===== NEW: 分页控件样式 ===== */
    #history-pagination {
        display: flex;
        justify-content: flex-end;
        align-items: center;
        margin-top: 20px;
    }
    .pagination-button {
        padding: 8px 16px;
        font-size: 14px;
        border: 1px solid #ddd;
        background-color: #f9f9f9;
        border-radius: 5px;
        cursor: pointer;
        margin: 0 5px;
    }
    .pagination-button:hover:not(:disabled) {
        background-color: #f0f0f0;
    }
    .pagination-button:disabled {
        cursor: not-allowed;
        opacity: 0.5;
    }
    #page-info {
        margin: 0 15px;
        font-size: 14px;
        color: #555;
    }
    /* --- CSS 结束 --- */
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/55/Rocket_icon.svg/2048px-Rocket_icon.svg.png" alt="logo" class="logo" />
      <div class="logo-text">CODENOVA</div>
    </div>
    <div class="dashboard">
      <!-- 列 1: 左侧信息卡片 -->
      <div class="card" id="networth-card">
        <h2>Networth</h2>
        <p>$37,150</p>
      </div>
      <div class="card" id="stock-assets-card">
        <h2>Stock</h2>
        <div class="asset-list-container">
          <div class="asset-item"><span>AAPL</span><span>$4,450</span></div>
          <div class="asset-item"><span>TSLA</span><span>$3,200</span></div>
          <div class="asset-item"><span>GOOGL</span><span>$2,800</span></div>
          <div class="asset-item"><span>MSFT</span><span>$2,150</span></div>
          <div class="asset-item"><span>AMZN</span><span>$1,900</span></div>
        </div>
        <div class="card-actions">
          <button class="card-action-button">+ Buy</button>
          <button class="card-action-button">- Sell</button>
        </div>
      </div>
      <div class="card" id="bond-card">
        <h2>Bond</h2>
        <div class="asset-list-container">
          <div class="asset-item"><span>US Treasury</span><span>$4,200</span></div>
          <div class="asset-item"><span>Corp Bond A</span><span>$2,500</span></div>
          <div class="asset-item"><span>Muni Bond B</span><span>$1,800</span></div>
          <div class="asset-item"><span>Intl Bond C</span><span>$1,500</span></div>
          <div class="asset-item"><span>High-Yield D</span><span>$1,200</span></div>
        </div>
        <div class="card-actions">
          <button class="card-action-button">+ Buy</button>
          <button class="card-action-button">- Sell</button>
        </div>
      </div>
      <div class="card" id="cash-card">
        <h2>Cash</h2>
        <div class="asset-list-container">
          <div class="asset-item"><span>USD Account</span><span>$3,800</span></div>
          <div class="asset-item"><span>Money Market</span><span>$2,200</span></div>
          <div class="asset-item"><span>EUR Account</span><span>$1,500</span></div>
          <div class="asset-item"><span>GBP Account</span><span>$950</span></div>
          <div class="asset-item"><span>CD #123</span><span>$3,000</span></div>
        </div>
        <div class="card-actions">
          <button class="card-action-button">+ Deposit</button>
          <button class="card-action-button">- Withdraw</button>
        </div>
      </div>

      <!-- 列 2: 中间图表 -->
      <div class="card" id="stock-chart-card">
        <h2>Stock</h2>
        <div class="chart-container-large">
          <canvas id="stockChart"></canvas>
        </div>
      </div>
      
      <div class="card" id="portfolio-card">
        <h2>Portfolio</h2>
        <div id="portfolio-charts-container">
          <div class="portfolio-chart-wrapper">
            <canvas id="portfolioChart1"></canvas>
          </div>
          <div class="portfolio-chart-wrapper">
            <canvas id="portfolioChart2"></canvas>
          </div>
        </div>
      </div>

      <!-- 列 3: 市场观察 -->
      <div class="card" id="market-watch-card">
        <h2>Market Watch</h2>
        <div id="stock-list-container"></div>
        <button class="refresh-button">Refresh</button>
        <p class="timestamp">Last updated: Just now</p>
      </div>
      
      <!-- 底部行: 历史记录 -->
      <div class="card" id="history-card">
        <h2>History</h2>
        <table class="history-table">
          <thead>
            <tr>
              <th>Date</th>
              <th>Assets-name</th>
              <th>Type</th>
              <th>Quantity</th>
              <th>Amount</th>
            </tr>
          </thead>
          <tbody>
            <!-- 内容将由 JavaScript 动态生成 -->
          </tbody>
        </table>
        <!-- ===== NEW: 分页控件 ===== -->
        <div id="history-pagination">
            <button id="prev-page-btn" class="pagination-button">上一页</button>
            <span id="page-info"></span>
            <button id="next-page-btn" class="pagination-button">下一页</button>
        </div>
      </div>
    </div>
  </div>
  <script>
    // --- 图表和列表的脚本 ---

    const ctxPortfolio1 = document.getElementById('portfolioChart1');
    if (ctxPortfolio1) {
      new Chart(ctxPortfolio1, {
        type: 'pie',
        data: {
          labels: ['股票 (Stock)', '债券 (Bond)', '现金 (Cash)'],
          datasets: [{
            label: 'Portfolio',
            data: [14500, 11200, 11450], 
            backgroundColor: ['#0047AB', '#FFA500', '#4DA6FF'],
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { position: 'top' },
            title: { display: true, text: '资产类别分布' }
          }
        }
      });
    }

    const ctxPortfolio2 = document.getElementById('portfolioChart2');
    if (ctxPortfolio2) {
      new Chart(ctxPortfolio2, {
        type: 'pie',
        data: {
          labels: ['科技 (Tech)', '金融 (Finance)', '消费 (Consumer)', '其他 (Other)'],
          datasets: [{
            label: 'Stock Sectors',
            data: [65, 15, 10, 10],
            backgroundColor: ['#28a745', '#dc3545', '#ffc107', '#6c757d'],
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { position: 'top' },
            title: { display: true, text: '股票行业分布 (示例)' }
          }
        }
      });
    }

    const ctx2 = document.getElementById('stockChart');
    if (ctx2) {
      new Chart(ctx2, {
        type: 'line',
        data: {
          labels: ['Jan 1', 'Jan 5', 'Jan 10', 'Jan 15', 'Jan 20', 'Jan 25', 'Jan 31'],
          datasets: [{
            label: 'Stock Value',
            data: [50, 90, 120, 160, 210, 190, 250],
            fill: true,
            backgroundColor: 'rgba(77, 166, 255, 0.1)',
            borderColor: '#0066ff',
            tension: 0.3
          }]
        },
        options: {
          scales: { y: { beginAtZero: true } },
          plugins: { legend: { display: false } },
          maintainAspectRatio: false
        }
      });
    }

    const mockStockData = [
      { code: 'AAPL', price: 172.25, changePercent: 1.47 },
      { code: 'GOOGL', price: 138.50, changePercent: -0.54 },
      { code: 'TSLA', price: 180.01, changePercent: 2.15 },
      { code: 'NVDA', price: 475.69, changePercent: -1.20 },
      { code: 'BABA', price: 75.10, changePercent: 3.50 },
      { code: 'META', price: 330.45, changePercent: 0.88 },
      { code: 'MSFT', price: 410.55, changePercent: 0.95 },
    ];

    function renderStockList(data) {
      const container = document.getElementById('stock-list-container');
      if (!container) return;
      container.innerHTML = '';
      data.forEach(stock => {
        const changeClass = stock.changePercent >= 0 ? 'positive' : 'negative';
        const changeSign = stock.changePercent >= 0 ? '+' : '';
        const itemHTML = `
          <div class="stock-info-item">
            <div class="stock-details">
              <span class="code">${stock.code}</span>
              <span class="price">$${stock.price.toFixed(2)}</span>
            </div>
            <div class="stock-change ${changeClass}">
              ${changeSign}${stock.changePercent.toFixed(2)}%
            </div>
          </div>
        `;
        container.innerHTML += itemHTML;
      });
    }

    // ===== PAGINATION LOGIC =====

    // 1. 数据和状态变量
    const mockHistoryData = [
        { date: '2024-02-01 10:30:15', name: 'AAPL', type: 'Stock', quantity: 17, amount: 3000 },
        { date: '2024-01-28 14:05:50', name: 'US Treasury', type: 'Bond', quantity: 2, amount: 2000 },
        { date: '2024-01-25 16:01:11', name: 'TSLA', type: 'Stock', quantity: 8, amount: -1500 },
        { date: '2024-01-22 11:45:30', name: 'EUR Account', type: 'Cash', quantity: '-', amount: -500 },
        { date: '2024-01-20 09:30:00', name: 'GOOGL', type: 'Stock', quantity: 15, amount: 2000 },
        { date: '2024-01-15 12:00:18', name: 'Corp Bond A', type: 'Bond', quantity: 5, amount: -2500 },
        { date: '2024-01-10 13:10:05', name: 'NVDA', type: 'Stock', quantity: 3, amount: 1200 },
        { date: '2024-01-05 15:25:45', name: 'MSFT', type: 'Stock', quantity: 2, amount: -800 },
        { date: '2023-12-28 10:05:00', name: 'AMZN', type: 'Stock', quantity: 10, amount: 2500 },
        { date: '2023-12-22 09:00:00', name: 'USD Account', type: 'Cash', quantity: '-', amount: 5000 },
        { date: '2023-12-18 11:15:21', name: 'High-Yield D', type: 'Bond', quantity: 12, amount: 1200 },
        { date: '2023-12-15 14:20:00', name: 'Money Market', type: 'Cash', quantity: '-', amount: 2200 },
    ];
    let currentPage = 1;
    const itemsPerPage = 5; // 每页显示5条

    // 2. DOM 元素引用
    const prevButton = document.getElementById('prev-page-btn');
    const nextButton = document.getElementById('next-page-btn');
    const pageInfoSpan = document.getElementById('page-info');
    const tableBody = document.querySelector('#history-card tbody');

    // 3. 渲染和更新函数
    function displayPage() {
        tableBody.innerHTML = '';
        const totalPages = Math.ceil(mockHistoryData.length / itemsPerPage);
        
        // 计算当前页的数据
        const startIndex = (currentPage - 1) * itemsPerPage;
        const endIndex = startIndex + itemsPerPage;
        const paginatedItems = mockHistoryData.slice(startIndex, endIndex);

        // 渲染数据
        paginatedItems.forEach(item => {
            const amountSign = item.amount >= 0 ? '+' : '-';
            const amountClass = item.amount >= 0 ? 'amount-positive' : 'amount-negative';
            const formattedAmount = `${amountSign}$${Math.abs(item.amount).toLocaleString()}`;
            const row = `
                <tr>
                    <td>${item.date}</td>
                    <td>${item.name}</td>
                    <td>${item.type}</td>
                    <td>${item.quantity}</td>
                    <td class="${amountClass}">${formattedAmount}</td>
                </tr>
            `;
            tableBody.innerHTML += row;
        });

        // 更新页码信息和按钮状态
        pageInfoSpan.textContent = `第 ${currentPage} 页 / 共 ${totalPages} 页`;
        prevButton.disabled = currentPage === 1;
        nextButton.disabled = currentPage === totalPages;
    }

    // 4. 事件监听
    prevButton.addEventListener('click', () => {
        if (currentPage > 1) {
            currentPage--;
            displayPage();
        }
    });

    nextButton.addEventListener('click', () => {
        const totalPages = Math.ceil(mockHistoryData.length / itemsPerPage);
        if (currentPage < totalPages) {
            currentPage++;
            displayPage();
        }
    });


    // --- 页面加载时初始化 ---
    document.addEventListener('DOMContentLoaded', () => {
      renderStockList(mockStockData);
      displayPage(); // 初始加载时显示第一页
    });
  </script>
</body>
</html>